{"version":3,"sources":["uni-app:///main.js","webpack:///D:/appshuo/oneCode/Yima/pages/jump/genPic.vue?a6f9","webpack:///D:/appshuo/oneCode/Yima/pages/jump/genPic.vue?37c0","webpack:///D:/appshuo/oneCode/Yima/pages/jump/genPic.vue?f85a","webpack:///D:/appshuo/oneCode/Yima/pages/jump/genPic.vue?7132","uni-app:///pages/jump/genPic.vue"],"names":["createPage","Page"],"mappings":";;;;;;;;;;kDAAA;AACA;AACA,6F;AACAA,UAAU,CAACC,eAAD,CAAV,C;;;;;;;;;;;;;ACHA;AAAA;AAAA;AAAA;AAAA;AAAmH;AACnH;AAC0D;AACL;;;AAGrD;AACiO;AACjO,gBAAgB,uOAAU;AAC1B,EAAE,4EAAM;AACR,EAAE,iFAAM;AACR,EAAE,0FAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,qFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACtBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAA44B,CAAgB,k5BAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACuBh6B;AACA;AACA,wBADA,EADA;;AAIA,QAJA,kBAIA,MAJA,EAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAfA;AAgBA,SAhBA,qBAgBA;AACA;AACA;AACA,GAnBA;AAoBA,MApBA,kBAoBA;AACA;AACA,cADA;AAEA,eAFA,EAEA;AACA,gCAHA,EAGA;AACA,sBAJA,EAIA;AACA,kBALA;AAMA,iBANA;AAOA,iBAPA;AAQA,gBARA;AASA,eATA;AAUA,kBAVA;AAWA,aAXA;;AAaA,GAlCA;AAmCA;AACA;AACA,qBAFA,6BAEA,IAFA,EAEA;AACA;AACA,oBAFA,GAEA,KAFA;AAGA;AACA;AACA;AACA,mCADA;;;AAIA,uBALA,GAKA;AACA;AACA,kEADA;AAEA;AACA;AACA,uBAJA;AAKA;AACA;AACA;AACA,0CADA;AAEA,yCAFA;;AAIA,uBAXA;;AAaA,mBAdA,CALA;;;AAsBA;AACA;AACA;AACA;AACA,sDADA;;AAGA,yCAHA,EAGA;AACA,0CAJA,EAIA;AACA,oCALA,EAKA;AACA,oCANA,EAMA;;AAEA,uCARA,EAQA;AACA,wCATA,EASA;AACA,kCAVA,EAUA;AACA,mCAXA,EAWA;;AAEA,wCAbA,EAaA;AACA,yCAdA,EAcA;AACA,mCAfA,EAeA;AACA,oCAhBA,CAHA,CAmBA;;AAEA,0EArBA,CAqBA;;AAEA;AACA;AACA;;AAEA,+BA3BA,CA2BA;AACA,oCA5BA,CA4BA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,gDArCA,CAqCA;AACA,kDAtCA,CAsCA;;AAEA,gDAxCA,CAwCA;AACA,wCAzCA,CAyCA;AACA,qDA1CA,CA0CA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,gDAlDA,CAkDA;AACA,yDAnDA,CAmDA;;AAEA;AACA;AACA,gDAvDA,CAuDA;AACA,sDAxDA,CAwDA;;AAEA;AACA;AACA,gDA5DA,CA4DA;AACA,uDA7DA,CA6DA;;AAEA;AACA;AACA,gDAjEA,CAiEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,gDArFA,CAqFA;AACA,mDAtFA,CAsFA;;AAEA;AACA,gDAzFA,CAyFA;AACA,kDA1FA,CA0FA;;AAEA;AACA,gDA7FA,CA6FA;AACA,uDA9FA,CA8FA;;AAEA,sGAhGA,CAgGA;AACA,kGAjGA,CAiGA;AACA;AACA;AACA;AACA,4CADA;AAEA;AACA;AACA;AACA;AACA;AACA,yCADA;;AAGA,yBATA;AAUA;AACA;AACA,yCADA;;AAGA,yBAdA;AAeA;AACA;AACA;AACA,yBAlBA;;AAoBA,qBAtBA;AAuBA,mBAzHA;AA0HA,iBApJA;AAqJA,KAvJA;AAwJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KA1KA;AA2KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDADA;AAEA,yBAFA,qBAEA;AACA;AACA;AACA,gDADA;AAEA,kCAFA;AAGA,oCAHA;;AAKA,mBATA;AAUA,sBAVA,kBAUA;AACA;AACA,mCADA;AAEA,kCAFA;;AAIA,mBAfA;;AAiBA;AACA;AACA,WAxBA;AAyBA,kCAzBA;AA0BA,0CA1BA;;AA4BA,OA7BA,MA6BA;AACA;AACA,iBADA,mBACA,GADA,EACA;AACA;AACA;AACA;AACA,+CADA;AAEA,uBAFA,qBAEA;AACA;AACA;AACA,kDADA;AAEA,2BAFA,qBAEA;AACA;AACA;AACA,kDADA;AAEA,oCAFA;AAGA,sCAHA;;AAKA,qBATA;AAUA,wBAVA,kBAUA;AACA;AACA,qCADA;AAEA,oCAFA;;AAIA,qBAfA;;AAiBA,iBArBA;AAsBA,oBAtBA,kBAsBA;AACA;AACA;AACA;AACA;AACA,sCADA;AAEA,gCAFA;;AAIA,iBA9BA;;AAgCA,aAjCA,MAiCA;AACA;AACA;AACA;AACA,8CADA;AAEA,uBAFA,qBAEA;AACA;AACA;AACA,8CADA;AAEA,gCAFA;AAGA,kCAHA;;AAKA,iBATA;AAUA,oBAVA,kBAUA;AACA;AACA,iCADA;AAEA,gCAFA;;AAIA,iBAfA;;AAiBA;AACA,WAzDA;AA0DA,cA1DA,gBA0DA,GA1DA,EA0DA;AACA;AACA,WA5DA;;AA8DA;AACA,KA9QA,EAnCA,E","file":"pages/jump/genPic.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/jump/genPic.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./genPic.vue?vue&type=template&id=bfe7c09c&\"\nvar renderjs\nimport script from \"./genPic.vue?vue&type=script&lang=js&\"\nexport * from \"./genPic.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!C:\\\\Users\\\\Administrator\\\\Downloads\\\\HBuilderX.3.1.18.20210609\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/jump/genPic.vue\"\nexport default component.exports","export * from \"-!C:\\\\Users\\\\Administrator\\\\Downloads\\\\HBuilderX.3.1.18.20210609\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!C:\\\\Users\\\\Administrator\\\\Downloads\\\\HBuilderX.3.1.18.20210609\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--16-0!C:\\\\Users\\\\Administrator\\\\Downloads\\\\HBuilderX.3.1.18.20210609\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!C:\\\\Users\\\\Administrator\\\\Downloads\\\\HBuilderX.3.1.18.20210609\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!C:\\\\Users\\\\Administrator\\\\Downloads\\\\HBuilderX.3.1.18.20210609\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!C:\\\\Users\\\\Administrator\\\\Downloads\\\\HBuilderX.3.1.18.20210609\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./genPic.vue?vue&type=template&id=bfe7c09c&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!C:\\\\Users\\\\Administrator\\\\Downloads\\\\HBuilderX.3.1.18.20210609\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!C:\\\\Users\\\\Administrator\\\\Downloads\\\\HBuilderX.3.1.18.20210609\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!C:\\\\Users\\\\Administrator\\\\Downloads\\\\HBuilderX.3.1.18.20210609\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!C:\\\\Users\\\\Administrator\\\\Downloads\\\\HBuilderX.3.1.18.20210609\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!C:\\\\Users\\\\Administrator\\\\Downloads\\\\HBuilderX.3.1.18.20210609\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./genPic.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!C:\\\\Users\\\\Administrator\\\\Downloads\\\\HBuilderX.3.1.18.20210609\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!C:\\\\Users\\\\Administrator\\\\Downloads\\\\HBuilderX.3.1.18.20210609\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!C:\\\\Users\\\\Administrator\\\\Downloads\\\\HBuilderX.3.1.18.20210609\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!C:\\\\Users\\\\Administrator\\\\Downloads\\\\HBuilderX.3.1.18.20210609\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!C:\\\\Users\\\\Administrator\\\\Downloads\\\\HBuilderX.3.1.18.20210609\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./genPic.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view style=\"text-align: center;\">\r\n\t\t<view class=\"post\">\r\n\t\t    <tki-qrcode\r\n\t\t        ref=\"qrcode\"\r\n\t\t        :val=\"val\"\r\n\t\t        :size=\"200\"\r\n\t\t        background=\"#fff\"\r\n\t\t        foreground=\"#000\"\r\n\t\t        pdground=\"#000\"\r\n\t\t        :onval=\"false\"\r\n\t\t        :loadMake=\"false\"\r\n\t\t        @result=\"createCanvasImage\"\r\n\t\t        :show=\"false\"\r\n\t\t    ></tki-qrcode>\r\n\t\t    <view class=\"wrapper\"><canvas canvas-id=\"myCanvas\" style=\"width: 690px;height:1080px; position: fixed;top: -10000px;\"></canvas></view>\r\n\t\t</view>\r\n\t\t<image @click=\"saveShareImg(canvasToTempFilePath)\" style=\"width: 690upx; height: 1080upx; text-align: center;\" :src=\"canvasToTempFilePath\" mode=\"\"></image>\r\n\t</view>\r\n</template>\r\n \r\n<script>\r\nimport tkiQrcode from '@/components/qrcode/tki-qrcode.vue';\t\r\nexport default {\r\n\tcomponents: {\r\n\t    tkiQrcode\r\n\t},\r\n\tonLoad(option) {\r\n\t\tconsole.log(option)\r\n\t\tthis.coverUrl = option.coverImg;\r\n\t\tthis.company = option.company;\r\n\t\tthis.address = option.address;\r\n\t\tthis.phone = option.phone;\r\n\t\tthis.weixin = option.weixin;\r\n\t\tthis.userName = option.userName;\r\n\t\tthis.val = 'http://yima.hazer.top/h5/?clientId='+option.clientId;\r\n\t\tconsole.log(this.val)\r\n\t\t// this.createCanvasImage();\r\n\t},\r\n\tonReady() {\r\n\t\tconsole.log(this.val)\r\n\t\tthis.$refs.qrcode._makeCode();\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tratio: 1,\r\n\t\t\tctx: null, // 创建canvas对象\r\n\t\t\tcanvasToTempFilePath: null, // 保存最终生成的导出的图片地址\r\n\t\t\topenStatus: true, // 声明一个全局变量判断是否授权保存到相册\r\n\t\t\tcoverUrl: '',\r\n\t\t\tcompany: '',\r\n\t\t\taddress:'',\r\n\t\t\tweixin:'',\r\n\t\t\tphone:'',\r\n\t\t\tuserName:'',\r\n\t\t\tval: '',\r\n\t\t};\r\n\t},\r\n\tmethods: {\r\n\t\t// 生成海报\r\n\t\tasync createCanvasImage(path) {\r\n\t\t\tconsole.log('path:'+path)\r\n\t\t\tlet self = this;\r\n\t\t\t// 点击生成海报数据埋点\r\n\t\t\tif (!self.ctx) {\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\ttitle: '生成中...'\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\tlet cover = new Promise(function(resolve) {\r\n\t\t\t\t\tuni.getImageInfo({\r\n\t\t\t\t\t\tsrc: 'http://img.hazer.top/'+self.coverUrl,\r\n\t\t\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\t\t\tresolve(res.path);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfail: function(err) {\r\n\t\t\t\t\t\t\tconsole.log(err);\r\n\t\t\t\t\t\t\twx.showToast({\r\n\t\t\t\t\t\t\t\ttitle: '网络错误请重试',\r\n\t\t\t\t\t\t\t\ticon: 'loading'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n \r\n \r\n\t\t\t\tPromise.all([path,cover]).then(function(result) {\r\n\t\t\t\t\tconst ctx = uni.createCanvasContext('myCanvas');\r\n\t\t\t\t\tconsole.log(ctx, self.ratio, 'ctx');\r\n\t\t\t\t\tlet canvasWidthPx = 690 * self.ratio,\r\n\t\t\t\t\t\tcanvasHeightPx = 1080 * self.ratio,\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tavatarurl_width = 110, //绘制的头像宽度\r\n\t\t\t\t\t\tavatarurl_heigth = 110, //绘制的头像高度\r\n\t\t\t\t\t\tavatarurl_x = 95, //绘制的头像在画布上的位置\r\n\t\t\t\t\t\tavatarurl_y = 35, //绘制的头像在画布上的位置\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tcodeurl_width = 180, //绘制的二维码宽度\r\n\t\t\t\t\t\tcodeurl_heigth = 180, //绘制的二维码高度\r\n\t\t\t\t\t\tcodeurl_x = 70, //绘制的二维码在画布上的位置\r\n\t\t\t\t\t\tcodeurl_y = 840, //绘制的二维码在画布上的位置\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tcoverurl_width = 610, //绘制的封面宽度\r\n\t\t\t\t\t\tcoverurl_heigth = 350, //绘制的封面高度\r\n\t\t\t\t\t\tcoverurl_x = 40, //绘制的封面在画布上的位置\r\n\t\t\t\t\t\tcoverurl_y = 190; //绘制的封面在画布上的位置\r\n\t\t\t\t\t\t\r\n\t\t\t\t\tctx.drawImage('../../static/bg.jpg', 0, 0, 690, 1080); // 背景图片需要本地\r\n\t\t\t\t\t\r\n\t\t\t\t\t// 白底\r\n\t\t\t\t\tctx.setFillStyle('#ffffff')\r\n\t\t\t\t\tctx.fillRect(25, 175, 640, 880)\r\n\t\t\t\t\t\r\n\t\t\t\t\tctx.save(); // 先保存状态 已便于画完圆再用\r\n\t\t\t\t\tctx.beginPath(); //开始绘制\r\n\t\t\t\t\t//先画个圆   前两个参数确定了圆心 （x,y） 坐标  第三个参数是圆的半径  四参数是绘图方向  默认是false，即顺时针\r\n\t// \t\t\t\tctx.arc(avatarurl_width / 2 + avatarurl_x, avatarurl_heigth / 2 + avatarurl_y, avatarurl_width / 2, 0, Math.PI * 2, false);\r\n\t// \t\t\t\tctx.clip(); //画了圆 再剪切  原始画布中剪切任意形状和尺寸。一旦剪切了某个区域，则所有之后的绘图都会被限制在被剪切的区域内\r\n\t// \t\t\t\tctx.drawImage(result[0], avatarurl_x, avatarurl_y, avatarurl_width, avatarurl_heigth); // 推进去图片\r\n \r\n\t\t\t\t\t// ctx.restore(); //恢复之前保存的绘图上下文状态 可以继续绘制\r\n\t\t\t\t\t\r\n\t\t\t\t\tctx.font = 'normal bold 45px sans-serif';\r\n\t\t\t\t\tctx.setFillStyle('#ffffff'); // 文字颜色\r\n\t\t\t\t\tctx.fillText('亿码科技', 240, 85); // 绘制文字\r\n \r\n\t\t\t\t\tctx.setFillStyle('#ffffff'); // 文字颜色\r\n\t\t\t\t\tctx.setFontSize(30); // 文字字号\r\n\t\t\t\t\tctx.fillText('提供技术支持', 240, 130); // 绘制文字\r\n \r\n\t\t\t\t\tctx.font = 'normal bold 40px sans-serif';\r\n\t\t\t\t\tctx.setFillStyle('#222222');\r\n\t\t\t\t\tctx.fillText(self.company, 40, 600);\r\n \r\n                    ctx.drawImage('../../static/person.png', 37, 615, 35, 35);\r\n\t\t\t\t\tctx.font = 'normal normal 26px sans-serif';\r\n\t\t\t\t\tctx.setFillStyle('#666666'); // 文字颜色\r\n\t\t\t\t\tctx.fillText(self.userName, 80, 640); // 绘制文字\r\n\t\t\t\t\t\r\n\t\t\t\t\tctx.drawImage('../../static/phone.png', 40, 655, 30, 30);\r\n\t\t\t\t\tctx.font = 'normal normal 26px sans-serif';\r\n\t\t\t\t\tctx.setFillStyle('#666666'); // 文字颜色\r\n\t\t\t\t\tctx.fillText(self.phone, 80, 680); // 绘制文字\r\n\t\t\t\t\t\r\n\t\t\t\t\tctx.drawImage('../../static/wx.png', 45, 700, 25, 25);\r\n\t\t\t\t\tctx.font = 'normal normal 26px sans-serif';\r\n\t\t\t\t\tctx.setFillStyle('#666666'); // 文字颜色\r\n\t\t\t\t\tctx.fillText(self.weixin, 80, 720); // 绘制文字\r\n\t\t\t\t\t\r\n\t\t\t\t\tctx.drawImage('../../static/address.png', 40, 735, 30, 30);\r\n\t\t\t\t\tctx.font = 'normal normal 26px sans-serif';\r\n\t\t\t\t\tctx.setFillStyle('#666666'); // 文字颜色\r\n\t\t\t\t\tself.drawText(ctx, self.address, 80, 760, 30,500);\r\n\t\t\t\t\t//ctx.fillText(self.address, 80, 760); // 绘制文字\r\n \r\n\t\t\t\t\tctx.beginPath();\r\n\t\t\t\t\t// 设置线宽\r\n\t\t\t\t\tctx.lineWidth = 1;\r\n\t\t\t\t\t// 设置间距（参数为无限数组，虚线的样式会随数组循环）\r\n\t\t\t\t\tctx.setLineDash([10, 10]);\r\n\t\t\t\t\t// 移动画笔至坐标 x20 y20 的位置\r\n\t\t\t\t\tctx.moveTo(30, 810);\r\n\t\t\t\t\t// 绘制到坐标 x20 y100 的位置\r\n\t\t\t\t\tctx.lineTo(660, 810);\r\n\t\t\t\t\t// 填充颜色\r\n\t\t\t\t\tctx.strokeStyle=\"#aaaaaa\";\r\n\t\t\t\t\t// 开始填充\r\n\t\t\t\t\tctx.stroke();\r\n\t\t\t\t\tctx.closePath();\r\n\t\t\t\t\t\r\n\t\t\t\t\tctx.font = 'normal normal 36px sans-serif';\r\n\t\t\t\t\tctx.setFillStyle('#E65449'); // 文字颜色\r\n\t\t\t\t\tctx.fillText('长按识别', 300, 910); // 绘制孩子百分比\r\n\t\t\t\t\t\r\n\t\t\t\t\tctx.font = 'normal normal 36px sans-serif';\r\n\t\t\t\t\tctx.setFillStyle('#222222'); // 文字颜色\r\n\t\t\t\t\tctx.fillText('二维码', 444, 910); // 绘制孩子百分比\r\n\t\t\t\t\t\r\n\t\t\t\t\tctx.font = 'normal normal 36px sans-serif';\r\n\t\t\t\t\tctx.setFillStyle('#222222'); // 文字颜色\r\n\t\t\t\t\tctx.fillText('查看更多详细信息', 300, 960); // 绘制孩子百分比\r\n\t\t\t\t\t\r\n\t\t\t\t\tctx.drawImage(result[1], coverurl_x, coverurl_y, coverurl_width, coverurl_heigth); // 绘制封面\r\n\t\t\t\t\tctx.drawImage(result[0], codeurl_x, codeurl_y, codeurl_width, codeurl_heigth); // 绘制头像\r\n\t\t\t\t\tctx.draw(false, function() {\r\n\t\t\t\t\t\t// canvas画布转成图片并返回图片地址\r\n\t\t\t\t\t\tuni.canvasToTempFilePath({\r\n\t\t\t\t\t\t\tcanvasId: 'myCanvas',\r\n\t\t\t\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\t\t\t\tself.canvasToTempFilePath = res.tempFilePath;\r\n\t\t\t\t\t\t\t\tself.showShareImg = true;\r\n\t\t\t\t\t\t\t\tconsole.log(res.tempFilePath, 'canvasToTempFilePath');\r\n\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\ttitle: '绘制成功'\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tfail: function() {\r\n\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\ttitle: '绘制失败'\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tcomplete: function() {\r\n\t\t\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t\t\t\tuni.hideToast();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n        drawText: function(ctx, str, leftWidth, initHeight, titleHeight, canvasWidth){\r\n\t\t\tlet lineWidth = 0;\r\n\t\t\tlet lastSubStrIndex = 0;\r\n\t\t\tfor(let i = 0; i < str.length; i++){\r\n\t\t\t\tlineWidth += ctx.measureText(str[i]).width;\r\n\t\t\t\tif(lineWidth > canvasWidth){\r\n\t\t\t\t\tctx.fillText(str.substring(lastSubStrIndex,i), leftWidth, initHeight);\r\n\t\t\t\t\tinitHeight += 30;\r\n\t\t\t\t\tlineWidth = 0;\r\n\t\t\t\t\tlastSubStrIndex = i;\r\n\t\t\t\t\ttitleHeight += 35;\r\n\t\t\t\t}\r\n\t\t\t\tif(i == str.length - 1){\r\n\t\t\t\t\tctx.fillText(str.substring(lastSubStrIndex, i+1), leftWidth, initHeight);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\ttitleHeight = titleHeight + 10;\r\n\t\t\treturn titleHeight;\r\n\t\t},\r\n\t\t// 保存到系统相册\r\n\t\tsaveShareImg: function(canvasToTempFilePath) {\r\n\t\t\tlet self = this;\r\n\t\t\t// 数据埋点点击保存海报\r\n\t\t\tself.saveId = '保存学情海报';\r\n\t\t\t// 获取用户是否开启用户授权相册\r\n\t\t\tif (!self.openStatus) {\r\n\t\t\t\tuni.openSetting({\r\n\t\t\t\t\tsuccess: result => {\r\n\t\t\t\t\t\tif (result) {\r\n\t\t\t\t\t\t\tif (result.authSetting['scope.writePhotosAlbum'] === true) {\r\n\t\t\t\t\t\t\t\tself.openStatus = true;\r\n\t\t\t\t\t\t\t\twx.saveImageToPhotosAlbum({\r\n\t\t\t\t\t\t\t\t\tfilePath: canvasToTempFilePath,\r\n\t\t\t\t\t\t\t\t\tsuccess() {\r\n\t\t\t\t\t\t\t\t\t\tself.showShareImg = false;\r\n\t\t\t\t\t\t\t\t\t\twx.showToast({\r\n\t\t\t\t\t\t\t\t\t\t\ttitle: '图片保存成功，快去分享到朋友圈吧~',\r\n\t\t\t\t\t\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\t\t\t\t\t\tduration: 2000\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\tfail() {\r\n\t\t\t\t\t\t\t\t\t\twx.showToast({\r\n\t\t\t\t\t\t\t\t\t\t\ttitle: '保存失败',\r\n\t\t\t\t\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: () => {},\r\n\t\t\t\t\tcomplete: () => {}\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tuni.getSetting({\r\n\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\t// 如果没有则获取授权\r\n\t\t\t\t\t\tif (!res.authSetting['scope.writePhotosAlbum']) {\r\n\t\t\t\t\t\t\twx.authorize({\r\n\t\t\t\t\t\t\t\tscope: 'scope.writePhotosAlbum',\r\n\t\t\t\t\t\t\t\tsuccess() {\r\n\t\t\t\t\t\t\t\t\tself.openStatus = true;\r\n\t\t\t\t\t\t\t\t\twx.saveImageToPhotosAlbum({\r\n\t\t\t\t\t\t\t\t\t\tfilePath: canvasToTempFilePath,\r\n\t\t\t\t\t\t\t\t\t\tsuccess() {\r\n\t\t\t\t\t\t\t\t\t\t\tself.showShareImg = false;\r\n\t\t\t\t\t\t\t\t\t\t\twx.showToast({\r\n\t\t\t\t\t\t\t\t\t\t\t\ttitle: '图片保存成功，快去分享到朋友圈吧~',\r\n\t\t\t\t\t\t\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\t\t\t\t\t\t\tduration: 2000\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\tfail() {\r\n\t\t\t\t\t\t\t\t\t\t\twx.showToast({\r\n\t\t\t\t\t\t\t\t\t\t\t\ttitle: '保存失败',\r\n\t\t\t\t\t\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tfail() {\r\n\t\t\t\t\t\t\t\t\t// 如果用户拒绝过或没有授权，则再次打开授权窗口\r\n\t\t\t\t\t\t\t\t\tself.openStatus = false;\r\n\t\t\t\t\t\t\t\t\tconsole.log('请设置允许访问相册');\r\n\t\t\t\t\t\t\t\t\twx.showToast({\r\n\t\t\t\t\t\t\t\t\t\ttitle: '请设置允许访问相册',\r\n\t\t\t\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t// 有则直接保存\r\n\t\t\t\t\t\t\tself.openStatus = true;\r\n\t\t\t\t\t\t\twx.saveImageToPhotosAlbum({\r\n\t\t\t\t\t\t\t\tfilePath: canvasToTempFilePath,\r\n\t\t\t\t\t\t\t\tsuccess() {\r\n\t\t\t\t\t\t\t\t\tself.showShareImg = false;\r\n\t\t\t\t\t\t\t\t\twx.showToast({\r\n\t\t\t\t\t\t\t\t\t\ttitle: '图片保存成功，快去分享到朋友圈吧~',\r\n\t\t\t\t\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\t\t\t\t\tduration: 2000\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tfail() {\r\n\t\t\t\t\t\t\t\t\twx.showToast({\r\n\t\t\t\t\t\t\t\t\t\ttitle: '保存失败',\r\n\t\t\t\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail(err) {\r\n\t\t\t\t\t\tconsole.log(err);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n};\r\n</script>\r\n \r\n<!-- // <style lang=\"scss\">\r\n// \t.post {\r\n// \t    height: 100%;\r\n// \t    background-color: #f4f4f4;\r\n\t\r\n// \t    .wrapper {\r\n// \t        height: 20rpx;\r\n// \t        display: flex;\r\n// \t        justify-content: center;\r\n// \t        align-items: center;\r\n// \t        margin-top: 50upx;\r\n// \t    }\r\n// \t} -->\r\n</style>"],"sourceRoot":""}